<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PLUS STORE | Luxury Boutique</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Raleway:wght@300;400;600&display=swap" rel="stylesheet">

    <style>
        :root {
            --primary: #000;
            --accent: #D4AF37; /* Dorado */
            --white: #fff;
            --light: #fdfdfd;
            --text: #333;
        }

        body { margin: 0; font-family: 'Raleway', sans-serif; background: var(--light); color: var(--text); }

        /* HEADER & NAV */
        .navbar { background: var(--white); padding: 15px 0; border-bottom: 1px solid #eee; position: sticky; top: 0; z-index: 1000; }
        .nav-top { display: flex; justify-content: space-between; align-items: center; max-width: 1200px; margin: 0 auto; padding: 0 20px; }
        .logo { font-family: 'Playfair Display', serif; font-size: 1.8rem; letter-spacing: 2px; color: var(--primary); margin: 0; }
        .logo span { color: var(--accent); }
        
        /* Men√∫ de P√°ginas */
        .nav-menu { display: flex; gap: 20px; list-style: none; margin: 0; padding: 0; }
        .nav-menu li button { background: none; border: none; font-family: 'Raleway'; font-weight: 600; cursor: pointer; text-transform: uppercase; font-size: 0.85rem; letter-spacing: 1px; transition: 0.3s; }
        .nav-menu li button:hover, .nav-menu li button.active { color: var(--accent); border-bottom: 2px solid var(--accent); }
        
        .nav-icons { display: flex; gap: 15px; }
        .icon-btn { background: none; border: none; font-size: 1.2rem; cursor: pointer; color: var(--primary); }

        /* HERO SECTION */
        .hero { 
            background: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)), url('https://images.unsplash.com/photo-1469334031218-e382a71b716b?auto=format&fit=crop&w=1600&q=80');
            background-size: cover; background-position: center; color: var(--white); text-align: center; padding: 100px 20px; margin-bottom: 40px;
        }
        .hero h2 { font-family: 'Playfair Display'; font-size: 3rem; margin: 0; }
        .btn-gold { background: var(--accent); color: white; padding: 12px 30px; text-transform: uppercase; border: none; cursor: pointer; letter-spacing: 2px; margin-top: 20px; }

        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .hidden { display: none; }

        /* FILTROS */
        .filters { background: white; padding: 20px; margin-bottom: 30px; border: 1px solid #eee; display: flex; gap: 20px; align-items: center; flex-wrap: wrap; justify-content: center; }
        .filter-group { display: flex; flex-direction: column; gap: 5px; }
        select, input[type="range"] { padding: 8px; border: 1px solid #ddd; }
        
        /* PRODUCTOS */
        .grid-container { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 30px; }
        .product-card { background: white; border: 1px solid #eee; transition: 0.3s; text-align: center; padding-bottom: 15px; }
        .product-card:hover { box-shadow: 0 10px 20px rgba(0,0,0,0.1); transform: translateY(-5px); }
        .product-photo { width: 100%; height: 300px; object-fit: cover; }
        .product-info { padding: 15px; }
        .product-name { font-weight: bold; margin: 5px 0; }
        .price { color: var(--accent); font-size: 1.1rem; }
        .btn-buy { background: black; color: white; border: none; padding: 10px; width: 80%; cursor: pointer; text-transform: uppercase; font-size: 0.8rem; margin-top: 10px; }

        /* RESE√ëAS */
        .reviews-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; }
        .review-card { background: white; padding: 20px; border-left: 4px solid var(--accent); box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .stars { color: var(--accent); letter-spacing: 2px; }
        .review-form { max-width: 500px; margin: 0 auto 40px; background: white; padding: 30px; border: 1px solid #ddd; text-align: center; }
        
        /* PEDIDO PERSONALIZADO */
        .custom-order-section { text-align: center; max-width: 600px; margin: 0 auto; background: white; padding: 40px; border: 2px solid var(--accent); }
        .upload-box { border: 2px dashed #ccc; padding: 30px; margin: 20px 0; cursor: pointer; }

        /* ADMIN */
        .admin-panel { background: #f8f8f8; border: 2px dashed #333; padding: 20px; margin-top: 20px; text-align: center; }
        input, select, textarea { width: 100%; padding: 10px; margin-bottom: 10px; box-sizing: border-box; border: 1px solid #ddd; }

        /* MODALES */
        .modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 2000; display: flex; justify-content: center; align-items: center; }
        .modal-content { background: white; padding: 30px; width: 90%; max-width: 400px; position: relative; text-align: center; }
        .close { position: absolute; top: 10px; right: 20px; font-size: 2rem; cursor: pointer; }
    </style>
</head>
<body>

    <nav class="navbar">
        <div class="nav-top">
            <h1 class="logo">PLUS<span>STORE</span></h1>
            
            <ul class="nav-menu">
                <li><button onclick="cambiarPagina('tienda')" class="active" id="btn-tienda">Tienda</button></li>
                <li><button onclick="cambiarPagina('resenas')" id="btn-resenas">Rese√±as</button></li>
                <li><button onclick="cambiarPagina('personalizado')" id="btn-personalizado">Encargos</button></li>
            </ul>

            <div class="nav-icons">
                <button onclick="abrirModal('cart-modal')" class="icon-btn"><i class="fas fa-shopping-bag"></i> <span id="cart-count">0</span></button>
                <button onclick="abrirModal('login-modal')" class="icon-btn"><i class="fas fa-user"></i></button>
            </div>
        </div>
    </nav>

    <div id="page-tienda">
        <header class="hero">
            <h2>Colecci√≥n Exclusiva</h2>
            <p>Moda, Estilo y Elegancia</p>
        </header>

        <div class="container filters">
            <div class="filter-group">
                <label>Categor√≠a</label>
                <select id="filter-category" onchange="aplicarFiltros()">
                    <option value="all">Todo el cat√°logo</option>
                    <option value="Ropa">Ropa</option>
                    <option value="Zapatos">Zapatos</option>
                    <option value="Relojes">Relojes</option>
                    <option value="Accesorios">Accesorios</option>
                </select>
            </div>
            <div class="filter-group">
                <label>Precio M√°ximo: <span id="price-val">500</span>‚Ç¨</label>
                <input type="range" id="filter-price" min="0" max="1000" value="500" oninput="actualizarPrecio(this.value)" onchange="aplicarFiltros()">
            </div>
        </div>

        <div class="container grid-container" id="productos-container">
            </div>
    </div>

    <div id="page-resenas" class="container hidden" style="margin-top: 40px;">
        <div class="review-form">
            <h2 class="logo">Dejar <span>Opini√≥n</span></h2>
            <form id="formResena">
                <input type="text" id="reviewName" placeholder="Tu Nombre" required>
                <select id="reviewStars">
                    <option value="5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê Excelente</option>
                    <option value="4">‚≠ê‚≠ê‚≠ê‚≠ê Muy bueno</option>
                    <option value="3">‚≠ê‚≠ê‚≠ê Normal</option>
                </select>
                <textarea id="reviewText" placeholder="Cu√©ntanos tu experiencia..." rows="3" required></textarea>
                <button type="submit" class="btn-gold">Publicar Rese√±a</button>
            </form>
        </div>
        
        <h3 style="text-align: center;">Lo que dicen nuestros clientes</h3>
        <div id="reviews-container" class="reviews-grid">
            </div>
    </div>

    <div id="page-personalizado" class="container hidden" style="margin-top: 40px;">
        <div class="custom-order-section">
            <i class="fas fa-camera" style="font-size: 3rem; color: var(--accent);"></i>
            <h2>¬øBuscas algo espec√≠fico?</h2>
            <p>Si no encuentras lo que buscas en nuestro cat√°logo, m√°ndanos una foto y te lo conseguimos.</p>
            
            <form id="customOrderForm">
                <input type="text" id="customName" placeholder="Tu Nombre" required>
                <textarea id="customDesc" placeholder="Describe lo que buscas (talla, color...)" rows="3"></textarea>
                
                <div class="upload-box" onclick="alert('üì∏ Al pulsar el bot√≥n ENVIAR, se abrir√° WhatsApp. Por favor, ADJUNTA LA FOTO dentro del chat.')">
                    <p>üì∏ La foto se adjuntar√° en WhatsApp</p>
                </div>

                <button type="submit" class="btn-gold" style="width: 100%;">Enviar a WhatsApp</button>
            </form>
        </div>
    </div>

    <div id="admin-panel" class="container admin-panel hidden">
        <h3>Gesti√≥n Plus Store</h3>
        <form id="addProductForm">
            <input type="file" id="newImg" accept="image/*" required>
            <input type="text" id="newName" placeholder="Nombre Producto" required>
            <select id="newCategory" required>
                <option value="Ropa">Ropa</option>
                <option value="Zapatos">Zapatos</option>
                <option value="Relojes">Relojes</option>
                <option value="Accesorios">Accesorios</option>
            </select>
            <input type="number" id="newPrice" placeholder="Precio (‚Ç¨)" required>
            <button type="submit" class="btn-buy">Subir Producto</button>
        </form>
        <button onclick="cerrarSesion()" style="margin-top:10px;">Salir</button>
    </div>

    <div id="cart-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close" onclick="cerrarModal('cart-modal')">&times;</span>
            <h2>Tu Bolsa</h2>
            <ul id="cart-items" style="list-style: none; padding: 0;"></ul>
            <h3>Total: <span id="total-price">0</span>‚Ç¨</h3>
            <button onclick="realizarPedido()" class="btn-gold">Pedir por WhatsApp</button>
        </div>
    </div>

    <div id="login-modal" class="modal hidden">
        <div class="modal-content" style="max-width: 300px;">
            <span class="close" onclick="cerrarModal('login-modal')">&times;</span>
            <h3>Staff Access</h3>
            <input type="password" id="adminPass" placeholder="Clave">
            <button onclick="verificarAdmin()" class="btn-buy">Entrar</button>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <script>
        // --- ‚ö†Ô∏è TUS CLAVES AQU√ç ---
        const firebaseConfig = {
            apiKey: "AIzaSyBFGONNSOyloukKKJeTYVRaEpFyzLSlRWw",
            authDomain: "plus-store-web.firebaseapp.com",
            projectId: "plus-store-web",
            storageBucket: "plus-store-web.firebasestorage.app",
            messagingSenderId: "918663622818",
            appId: "1:918663622818:web:a33e78f71b2314698ae7fb",
            measurementId: "G-PRVMPSW0Q1"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // Variables
        let carrito = [];
        let productosGlobal = []; // Para los filtros
        const MI_TELEFONO = "34607396568"; // ‚ö†Ô∏è PON TU N√öMERO

        // --- NAVEGACI√ìN ---
        function cambiarPagina(pag) {
            document.getElementById('page-tienda').classList.add('hidden');
            document.getElementById('page-resenas').classList.add('hidden');
            document.getElementById('page-personalizado').classList.add('hidden');
            
            document.getElementById('btn-tienda').classList.remove('active');
            document.getElementById('btn-resenas').classList.remove('active');
            document.getElementById('btn-personalizado').classList.remove('active');

            document.getElementById(`page-${pag}`).classList.remove('hidden');
            document.getElementById(`btn-${pag}`).classList.add('active');
        }

        // --- PRODUCTOS Y FILTROS ---
        function cargarProductos() {
            db.collection("productos").orderBy("fecha", "desc").get().then(snap => {
                productosGlobal = [];
                snap.forEach(doc => {
                    let data = doc.data();
                    data.id = doc.id;
                    productosGlobal.push(data);
                });
                aplicarFiltros(); // Mostrar todos al principio
            });
        }

        function actualizarPrecio(val) { document.getElementById('price-val').innerText = val; }

        function aplicarFiltros() {
            const cat = document.getElementById('filter-category').value;
            const maxPrice = Number(document.getElementById('filter-price').value);
            const container = document.getElementById('productos-container');
            
            container.innerHTML = "";

            const filtrados = productosGlobal.filter(p => {
                const pasaCategoria = cat === "all" || p.categoria === cat;
                const pasaPrecio = p.precio <= maxPrice;
                return pasaCategoria && pasaPrecio;
            });

            if(filtrados.length === 0) {
                container.innerHTML = "<p style='width:100%; text-align:center;'>No hay productos con estos filtros.</p>";
                return;
            }

            filtrados.forEach(p => {
                const div = document.createElement('div');
                div.className = "product-card";
                div.innerHTML = `
                    <img src="${p.img}" class="product-photo">
                    <div class="product-info">
                        <div class="product-name">${p.nombre}</div>
                        <div style="font-size:0.8rem; color:#777;">${p.categoria || 'Moda'}</div>
                        <div class="price">${p.precio}‚Ç¨</div>
                        <button class="btn-buy" onclick="addCart('${p.nombre}', ${p.precio})">A√±adir</button>
                        <button onclick="borrarProd('${p.id}')" class="hidden btn-admin-delete" style="color:red; border:none; background:none; cursor:pointer; font-size:0.8rem;">Eliminar</button>
                    </div>
                `;
                container.appendChild(div);
            });
            
            // Mostrar botones de borrar si es admin
            if(!document.getElementById('admin-panel').classList.contains('hidden')) {
                document.querySelectorAll('.btn-admin-delete').forEach(b => b.classList.remove('hidden'));
            }
        }

        // --- CARRITO ---
        function addCart(n, p) {
            carrito.push({n, p});
            document.getElementById('cart-count').innerText = carrito.length;
            alert("A√±adido a la bolsa");
        }

        function realizarPedido() {
            if(carrito.length === 0) return alert("Bolsa vac√≠a");
            let msj = "üëã Hola PLUS STORE, pedido web: \n";
            carrito.forEach(i => msj += `- ${i.n} (${i.p}‚Ç¨)\n`);
            window.open(`https://wa.me/${MI_TELEFONO}?text=${encodeURIComponent(msj)}`, '_blank');
            carrito = [];
            document.getElementById('cart-count').innerText = 0;
            cerrarModal('cart-modal');
        }

        // --- RESE√ëAS ---
        function cargarResenas() {
            db.collection("resenas").orderBy("fecha", "desc").limit(10).get().then(snap => {
                const div = document.getElementById('reviews-container');
                div.innerHTML = "";
                snap.forEach(doc => {
                    const r = doc.data();
                    let estrellas = "‚≠ê".repeat(r.estrellas);
                    div.innerHTML += `
                        <div class="review-card">
                            <div class="stars">${estrellas}</div>
                            <p>"${r.texto}"</p>
                            <small>- ${r.nombre}</small>
                        </div>
                    `;
                });
            });
        }

        document.getElementById('formResena').addEventListener('submit', function(e) {
            e.preventDefault();
            const n = document.getElementById('reviewName').value;
            const s = Number(document.getElementById('reviewStars').value);
            const t = document.getElementById('reviewText').value;

            db.collection("resenas").add({
                nombre: n, estrellas: s, texto: t, fecha: new Date()
            }).then(() => {
                alert("¬°Gracias por tu opini√≥n!");
                document.getElementById('formResena').reset();
                cargarResenas();
            });
        });

        // --- PEDIDO PERSONALIZADO (FOTO A WHATSAPP) ---
        document.getElementById('customOrderForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const name = document.getElementById('customName').value;
            const desc = document.getElementById('customDesc').value;
            
            const msj = `üì∏ *PEDIDO PERSONALIZADO*\n\nHola, soy ${name}.\nBusco un producto con estas caracter√≠sticas:\n"${desc}"\n\n(ADJUNTO FOTO A CONTINUACI√ìN)`;
            
            // Abrir WhatsApp
            window.open(`https://wa.me/${MI_TELEFONO}?text=${encodeURIComponent(msj)}`, '_blank');
        });

        // --- ADMIN ---
        function verificarAdmin() {
            if(document.getElementById('adminPass').value === "4354") {
                document.getElementById('admin-panel').classList.remove('hidden');
                cerrarModal('login-modal');
                aplicarFiltros(); // Refrescar para ver botones borrar
            } else { alert("Error"); }
        }
        function cerrarSesion() {
            document.getElementById('admin-panel').classList.add('hidden');
            aplicarFiltros();
        }

        document.getElementById('addProductForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const file = document.getElementById('newImg').files[0];
            const name = document.getElementById('newName').value;
            const cat = document.getElementById('newCategory').value;
            const price = Number(document.getElementById('newPrice').value);

            if(file.size > 1000000) return alert("Imagen muy grande (Max 1MB)");
            
            const reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = function() {
                db.collection("productos").add({
                    nombre: name, 
                    categoria: cat, 
                    precio: price, 
                    img: reader.result, 
                    fecha: new Date().toISOString()
                }).then(() => {
                    alert("Producto subido");
                    document.getElementById('addProductForm').reset();
                    cargarProductos();
                });
            };
        });

        function borrarProd(id) {
            if(confirm("¬øEliminar producto?")) {
                db.collection("productos").doc(id).delete().then(() => cargarProductos());
            }
        }

        // --- MODALES ---
        window.abrirModal = (id) => {
            document.getElementById(id).classList.remove('hidden');
            if(id === 'cart-modal') {
                const ul = document.getElementById('cart-items');
                ul.innerHTML = ""; let total = 0;
                carrito.forEach(i => { ul.innerHTML += `<li>${i.n} - ${i.p}‚Ç¨</li>`; total += i.p; });
                document.getElementById('total-price').innerText = total;
            }
        }
        window.cerrarModal = (id) => document.getElementById(id).classList.add('hidden');

        // INICIAR
        cargarProductos();
        cargarResenas();
    </script>
</body>
</html>